{
  "topicId": "tech-3-5-5",
  "title": "セキュリティ対策",
  "questions": [
    {
      "id": "tech-3-5-5-q1",
      "type": "multiple_choice",
      "question": "パケットフィルタリング型ファイアウォールのフィルタリングルールが次のように設定されている場合、外部（インターネット）から社内Webサーバ（192.168.1.100、ポート80）にHTTPアクセスしようとしたとき、どのルールが適用されますか？\n\n【ルール】\n①送信元IP=any、宛先IP=192.168.1.100、ポート=80、プロトコル=TCP → 許可\n②送信元IP=any、宛先IP=192.168.1.100、ポート=443、プロトコル=TCP → 許可\n③送信元IP=192.168.1.0/24、宛先IP=any、ポート=any、プロトコル=any → 許可\n④送信元IP=any、宛先IP=any、ポート=22、プロトコル=TCP → 遮断\n⑤送信元IP=any、宛先IP=any、ポート=any、プロトコル=any → 遮断",
      "options": [
        "ルール①が適用され、アクセスは許可される",
        "ルール③が適用され、アクセスは許可される",
        "ルール④が適用され、アクセスは遮断される",
        "ルール⑤が適用され、アクセスは遮断される"
      ],
      "correctAnswer": 0,
      "explanation": "「ルール①が適用され、アクセスは許可される」が正しいです。パケットフィルタリング型ファイアウォールは、ルールを上から順に評価し、最初にマッチしたルールを適用します。外部から社内Webサーバ（192.168.1.100、ポート80）にHTTPアクセスする場合、送信元IP=any（外部のIPアドレス）、宛先IP=192.168.1.100、ポート=80、プロトコル=TCPとなり、ルール①にマッチします。ルール①は「許可」なので、アクセスが許可されます。ルール③は送信元IPが192.168.1.0/24（社内ネットワーク）の場合に適用されるため、外部からのアクセスには適用されません。ルール④はポート22（SSH）の場合に適用されるため、ポート80のHTTPアクセスには適用されません。ルール⑤は、上記のルール①～④にマッチしなかった場合に適用される「デフォルト拒否」ルールです。"
    },
    {
      "id": "tech-3-5-5-q2",
      "type": "multiple_choice",
      "question": "IDS（侵入検知システム）とIPS（侵入防止システム）に関する説明として、最も適切なものはどれですか？",
      "options": [
        "IDSは攻撃を検知して自動的に遮断し、IPSは攻撃を検知して管理者に通知する",
        "IDSは通信経路上にインラインで設置し、IPSはスイッチのミラーポートに接続する",
        "IDSは攻撃を検知して管理者に通知し、IPSは攻撃を検知して自動的に遮断する",
        "IDSとIPSは同じ機能を持ち、設置場所も同じである"
      ],
      "correctAnswer": 2,
      "explanation": "「IDSは攻撃を検知して管理者に通知し、IPSは攻撃を検知して自動的に遮断する」が正しいです。IDS（Intrusion Detection System、侵入検知システム）は、ネットワークやホストへの不正なアクセスや攻撃を検知し、管理者に通知するシステムです。IDSは攻撃を「検知」するだけで、「防止」はしません。IPS（Intrusion Prevention System、侵入防止システム）は、IDSの機能に加えて、攻撃を自動的に「防止（遮断）」するシステムです。設置場所は、ネットワーク型IDS（NIDS）はスイッチのミラーポートに接続し（通信経路に介在しない）、ネットワーク型IPS（NIPS）は通信経路上にインラインで設置します（すべての通信がIPSを経由）。選択肢①は、IDSとIPSの機能が逆です。選択肢②は、設置場所が逆です。選択肢④は、IDSとIPSは異なる機能を持ちます。"
    },
    {
      "id": "tech-3-5-5-q3",
      "type": "multiple_choice",
      "question": "次のセキュリティ機器の説明のうち、WAF（Web Application Firewall）に関する説明として正しいものはどれですか？",
      "options": [
        "ネットワーク層（IP、ポート番号）の通信を制御し、不正なアクセスを防ぐ",
        "Webアプリケーションに特化したファイアウォールで、HTTPリクエストとHTTPレスポンスを検査し、SQLインジェクション、XSSなどの攻撃を検知・防止する",
        "ネットワークを流れる通信を監視し、不正なアクセスや攻撃を検知して管理者に通知するが、遮断はしない",
        "ウイルス、ワーム、トロイの木馬などのマルウェアを検知・駆除するソフトウェア"
      ],
      "correctAnswer": 1,
      "explanation": "「Webアプリケーションに特化したファイアウォールで、HTTPリクエストとHTTPレスポンスを検査し、SQLインジェクション、XSSなどの攻撃を検知・防止する」が正しいです。WAF（Web Application Firewall）は、Webアプリケーションに特化したファイアウォールです。WAFは、HTTPリクエストとHTTPレスポンスを検査し、SQLインジェクション、XSS（クロスサイトスクリプティング）、ディレクトリトラバーサル、コマンドインジェクション、セッションハイジャックなどのWebアプリケーションへの攻撃を検知・防止します。WAFは、Webサーバの前に設置され、すべてのHTTP/HTTPS通信を検査します。選択肢①は、通常のファイアウォール（パケットフィルタリング型）の説明です。選択肢③は、IDS（侵入検知システム）の説明です。選択肢④は、ウイルス対策ソフトの説明です。"
    },
    {
      "id": "tech-3-5-5-q4",
      "type": "multiple_choice",
      "question": "DMZ（非武装地帯）に関する説明として、最も適切なものはどれですか？",
      "options": [
        "内部ネットワークと外部ネットワーク（インターネット）の間に設置される中間ネットワークで、Webサーバ、メールサーバ、DNSサーバなど、外部に公開するサーバを配置する",
        "社内の重要なサーバ（DBサーバ、ファイルサーバ）を配置し、外部からのアクセスを完全に遮断するネットワーク",
        "ファイアウォールの内側に配置され、社員のPC、プリンタ、ファイルサーバなどを接続するネットワーク",
        "インターネットと直接接続され、ファイアウォールを経由せずに通信できるネットワーク"
      ],
      "correctAnswer": 0,
      "explanation": "「内部ネットワークと外部ネットワーク（インターネット）の間に設置される中間ネットワークで、Webサーバ、メールサーバ、DNSサーバなど、外部に公開するサーバを配置する」が正しいです。DMZ（DeMilitarized Zone、非武装地帯）は、内部ネットワークと外部ネットワーク（インターネット）の間に設置される、中間ネットワークです。DMZには、外部に公開するサーバ（Webサーバ、メールサーバ、DNSサーバ）を設置します。DMZを設置することで、外部からの攻撃がWebサーバに成功しても、内部ネットワークへの侵入を防ぐことができます。DMZは、2つのファイアウォールで挟まれた構成が一般的です（外部ファイアウォールと内部ファイアウォール）。選択肢②は、内部ネットワークの説明です。選択肢③も、内部ネットワークの説明です。選択肢④は、DMZではなく、セキュリティ上危険な構成です。"
    },
    {
      "id": "tech-3-5-5-q5",
      "type": "multiple_choice",
      "question": "次のコードのうち、SQLインジェクション対策として最も適切なものはどれですか？（Pythonの疑似コード）",
      "options": [
        "user_id = request.GET['id']\nquery = \"SELECT * FROM users WHERE id = '\" + user_id + \"'\"\nresults = db.execute(query)",
        "user_id = request.GET['id']\nquery = \"SELECT * FROM users WHERE id = ?\"\nresults = db.execute(query, (user_id,))",
        "user_id = request.GET['id']\nquery = f\"SELECT * FROM users WHERE id = '{user_id}'\"\nresults = db.execute(query)",
        "user_id = request.GET['id']\nquery = \"SELECT * FROM users WHERE id = %s\" % user_id\nresults = db.execute(query)"
      ],
      "correctAnswer": 1,
      "explanation": "「user_id = request.GET['id']\nquery = \"SELECT * FROM users WHERE id = ?\"\nresults = db.execute(query, (user_id,))」が正しいです。これは、プリペアドステートメント（プレースホルダを使用）を使ったコードで、SQLインジェクション対策として最も適切です。プリペアドステートメントでは、SQLクエリとパラメータを分離し、パラメータはSQL文の一部ではなく、データとして扱われます。特殊文字（'、\"）が自動的にエスケープされるため、SQLインジェクション攻撃が無効化されます。選択肢①③④は、文字列結合やフォーマット文字列を使ってSQLクエリを構築しているため、SQLインジェクションの脆弱性があります。例えば、user_id = \"123' OR '1'='1\" を入力すると、query = \"SELECT * FROM users WHERE id = '123' OR '1'='1'\" となり、条件「'1'='1'」は常に真なので、全ユーザーの情報が取得されます（SQLインジェクション攻撃が成功）。"
    },
    {
      "id": "tech-3-5-5-q6",
      "type": "multiple_choice",
      "question": "脆弱性診断とペネトレーションテストに関する説明として、最も適切なものはどれですか？",
      "options": [
        "脆弱性診断は、実際に攻撃者のように侵入を試み、システムの脆弱性を検証する。ペネトレーションテストは、自動診断ツールで既知の脆弱性を自動的に検査する",
        "脆弱性診断は、システムやアプリケーションに脆弱性がないか調査する。ペネトレーションテストは、実際に攻撃者のように侵入を試み、脆弱性を悪用してどこまで侵入できるかを検証する",
        "脆弱性診断とペネトレーションテストは同じもので、目的と手法も同じである",
        "脆弱性診断は、ネットワークの脆弱性のみを検査する。ペネトレーションテストは、Webアプリケーションの脆弱性のみを検査する"
      ],
      "correctAnswer": 1,
      "explanation": "「脆弱性診断は、システムやアプリケーションに脆弱性がないか調査する。ペネトレーションテストは、実際に攻撃者のように侵入を試み、脆弱性を悪用してどこまで侵入できるかを検証する」が正しいです。脆弱性診断（Vulnerability Assessment）は、システムやアプリケーションに脆弱性がないか調査することです。自動診断ツール（OWASP ZAP、Nessus）で既知の脆弱性を自動的に検査します。「脆弱性があるか」を確認します（広く浅く）。ペネトレーションテスト（Penetration Test、侵入テスト）は、実際に攻撃者のように侵入を試み、システムの脆弱性を検証するテストです。脆弱性の発見 → 脆弱性の悪用 → システムへの侵入 → 重要データへのアクセス → 痕跡の消去、という流れで実施します。「脆弱性を悪用できるか」を確認します（狭く深く）。選択肢①は、脆弱性診断とペネトレーションテストの説明が逆です。選択肢③は、脆弱性診断とペネトレーションテストは異なる目的と手法を持ちます。選択肢④は、脆弱性診断とペネトレーションテストの対象範囲が間違っています。"
    },
    {
      "id": "tech-3-5-5-q7",
      "type": "multiple_choice",
      "question": "OWASP Top 10に含まれるWebアプリケーションの脅威として、正しいものはどれですか？",
      "options": [
        "DDoS攻撃（分散型サービス拒否攻撃）",
        "SQLインジェクション（Injection）",
        "標的型攻撃（APT: Advanced Persistent Threat）",
        "ランサムウェア（Ransomware）"
      ],
      "correctAnswer": 1,
      "explanation": "「SQLインジェクション（Injection）」が正しいです。OWASP（Open Web Application Security Project）は、Webアプリケーションのセキュリティを向上させるための非営利団体で、「OWASP Top 10」という、Webアプリケーションの10大脅威を公開しています。OWASP Top 10（2021年版）には、①A01: アクセス制御の不備、②A02: 暗号化の失敗、③A03: インジェクション（SQLインジェクション、コマンドインジェクション）、④A04: 安全でない設計、⑤A05: セキュリティの設定ミス、⑥A06: 脆弱で古いコンポーネント、⑦A07: 識別と認証の失敗、⑧A08: ソフトウェアとデータの整合性の不備、⑨A09: セキュリティログとモニタリングの不備、⑩A10: サーバサイドリクエストフォージェリ、が含まれています。選択肢①DDoS攻撃は、ネットワーク層の攻撃で、OWASP Top 10には含まれていません。選択肢③標的型攻撃（APT）は、特定の組織を狙った長期的な攻撃で、OWASP Top 10には含まれていません。選択肢④ランサムウェアは、マルウェアの一種で、OWASP Top 10には含まれていません。"
    },
    {
      "id": "tech-3-5-5-q8",
      "type": "multiple_choice",
      "question": "ISMS（情報セキュリティマネジメントシステム）のPDCAサイクルにおいて、「Check（評価）」フェーズで実施する作業として、最も適切なものはどれですか？",
      "options": [
        "情報セキュリティポリシーの策定、リスクアセスメント、セキュリティ対策の計画",
        "セキュリティ対策の実施（ファイアウォールの設置、ウイルス対策ソフトのインストール、セキュリティ教育）",
        "内部監査と外部監査の実施、ISO/IEC 27001の認証取得",
        "監査結果に基づく改善（セキュリティパッチの自動更新を有効化、パスワードポリシーの強化）"
      ],
      "correctAnswer": 2,
      "explanation": "「内部監査と外部監査の実施、ISO/IEC 27001の認証取得」が正しいです。ISMSのPDCAサイクルは、①Plan（計画）：情報セキュリティポリシーの策定、リスクアセスメント、セキュリティ対策の計画、②Do（実行）：セキュリティ対策の実施（ファイアウォールの設置、ウイルス対策ソフトのインストール、セキュリティパッチの適用、セキュリティ教育）、③Check（評価）：内部監査と外部監査の実施、ISO/IEC 27001の認証取得、④Act（改善）：監査結果に基づき、セキュリティ対策を改善（例: セキュリティパッチの自動更新を有効化、パスワードポリシーの強化）、の4つのフェーズで構成されます。選択肢①は、Plan（計画）フェーズの作業です。選択肢②は、Do（実行）フェーズの作業です。選択肢④は、Act（改善）フェーズの作業です。"
    },
    {
      "id": "tech-3-5-5-q9",
      "type": "multiple_choice",
      "question": "インシデント対応のフェーズにおいて、「初動対応（Containment）」で実施すべき作業として、最も適切なものはどれですか？",
      "options": [
        "ウイルス対策ソフト、IDS/IPSのアラート確認、ログ分析",
        "感染したPCの隔離、ネットワークの遮断、緊急連絡",
        "フォレンジック調査、ログ分析、マルウェアの解析",
        "報告書作成、再発防止策の実施、プロセスの見直し"
      ],
      "correctAnswer": 1,
      "explanation": "「感染したPCの隔離、ネットワークの遮断、緊急連絡」が正しいです。インシデント対応は、①検知（Detection）：ウイルス対策ソフト、IDS/IPSのアラート確認、ログ分析 → インシデントを早期に発見、②初動対応（Containment）：感染したPCの隔離、ネットワークの遮断、緊急連絡 → 被害の拡大を防止、③根本原因の分析（Eradication）：フォレンジック調査、ログ分析、マルウェアの解析 → インシデントの原因を特定し、完全に除去、④復旧（Recovery）：OSの再インストール、バックアップからの復元、システムの再起動 → システムを正常な状態に戻す、⑤事後対応（Post-Incident Activity）：報告書作成、再発防止策の実施、プロセスの見直し → 同じインシデントの再発を防止、の5つのフェーズで構成されます。初動対応（Containment）では、被害の拡大を防ぐため、感染したPCをネットワークから切り離す（隔離）、ネットワークを遮断する、などの作業を実施します。選択肢①は、検知（Detection）フェーズの作業です。選択肢③は、根本原因の分析（Eradication）フェーズの作業です。選択肢④は、事後対応（Post-Incident Activity）フェーズの作業です。"
    },
    {
      "id": "tech-3-5-5-q10",
      "type": "multiple_choice",
      "question": "あるECサイトで、ランサムウェアに感染し、ファイルが暗号化されました。バックアップからデータを復旧したいのですが、バックアップ方式が次のように設定されていた場合、復旧に必要なバックアップファイルとして正しいものはどれですか？\n\n【バックアップ設定】\n・日曜日：フルバックアップ\n・月曜日～土曜日：差分バックアップ\n・感染日時：水曜日の午前10時\n・最新のバックアップ：水曜日の午前0時（差分バックアップ）",
      "options": [
        "日曜日のフルバックアップのみ",
        "日曜日のフルバックアップ + 水曜日の差分バックアップ",
        "月曜日、火曜日、水曜日の差分バックアップ",
        "水曜日の差分バックアップのみ"
      ],
      "correctAnswer": 1,
      "explanation": "「日曜日のフルバックアップ + 水曜日の差分バックアップ」が正しいです。差分バックアップは、前回のフルバックアップ以降に変更されたデータをバックアップする方式です。復旧には、①フルバックアップ + ②最新の差分バックアップ、の2つのファイルが必要です。この問題では、日曜日にフルバックアップを取得し、月曜日～土曜日に差分バックアップを取得しています。水曜日の午前10時に感染した場合、最新のバックアップは水曜日の午前0時の差分バックアップです。復旧には、①日曜日のフルバックアップ + ②水曜日の差分バックアップ、の2つのファイルが必要です。まず、日曜日のフルバックアップを復元し、次に水曜日の差分バックアップを復元します。これで、水曜日の午前0時時点のデータに復旧できます（午前0時～午前10時のデータは失われます）。選択肢①は、日曜日のフルバックアップのみでは、日曜日時点のデータしか復旧できません。選択肢③は、差分バックアップのみでは、フルバックアップがないため復旧できません。選択肢④も、差分バックアップのみでは復旧できません。"
    }
  ]
}
